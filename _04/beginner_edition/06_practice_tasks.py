"""
–ú–æ–¥—É–ª—å 4.6: –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –ó–∞–≤–¥–∞–Ω–Ω—è —Ç–∞ –ü—Ä–æ–µ–∫—Ç–∏ - Beginner Edition
==============================================================

–¶–µ –ø—Ä–∞–∫—Ç–∏—á–Ω–∏–π –º–æ–¥—É–ª—å –¥–ª—è –∑–∞–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö –Ω–∞–≤–∏—á–æ–∫ –º–æ–¥—É–ª—è 4.
–í–∫–ª—é—á–∞—î —Ä–µ–∞–ª—å–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è –¥–ª—è:
- –†–æ–±–æ—Ç–∞ –∑ –¥–∞—Ç–∞–º–∏ —Ç–∞ —á–∞—Å–æ–º
- –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏
- –¢–µ–∫—Å—Ç–æ–≤–∞ –æ–±—Ä–æ–±–∫–∞ (regex)
- –†–æ–±–æ—Ç–∞ –∑ —Ñ–∞–π–ª–∞–º–∏
- –û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—è –∫–æ–¥—É –≤ –º–æ–¥—É–ª—ñ

–¶–µ –≤–µ—Ä—Å—ñ—è –¥–ª—è –Ω–æ–≤–∞—á–∫—ñ–≤ - —Ä–µ–∞–ª—å–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –∑ –ø–æ—è—Å–Ω–µ–Ω–Ω—è–º–∏.
"""

import datetime
import random
import re
import csv
import os
import json
from collections import Counter

print("=" * 70)
print("–ú–û–î–£–õ–¨ 4.6: –ü–†–ê–ö–¢–ò–ß–ù–Ü –ó–ê–í–î–ê–ù–ù–Ø - BEGINNER EDITION")
print("=" * 70)

# ============================================================================
# 1. –ü–†–û–ï–ö–¢ 1: –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† IDADE
# ============================================================================

print("\n" + "=" * 70)
print("–ü–†–û–ï–ö–¢ 1: –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† IDADE (–î–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è)")
print("=" * 70)

print("""
–ó–∞–≤–¥–∞–Ω–Ω—è: –ù–∞–ø–∏—à—ñ—Ç—å –ø—Ä–æ–≥—Ä–∞–º—É —â–æ —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î:
  1. –í—ñ–∫ –ª—é–¥–∏–Ω–∏ –∑–∞ –¥–∞—Ç–æ—é –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
  2. –°–∫—ñ–ª—å–∫–∏ –¥–Ω—ñ–≤ –∑–∞–ª–∏—à–∏–ª–æ—Å—å –¥–æ –¥–Ω—è –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
  3. –í —è–∫–æ–º—É —Å—Ç–æ–ª—ñ—Ç—Ç—ñ –Ω–∞—Ä–æ–¥–∏–ª–∞—Å—å –ª—é–¥–∏–Ω–∞

–ù–∞–≤–∏—á–∫–∏: datetime, timedelta, –æ–±—á–∏—Å–ª–µ–Ω–Ω—è
""")

def calculate_age_info(birth_date_str):
    """
    –û–±—á–∏—Å–ª—é—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –≤—ñ–∫.
    –ê—Ä–≥—É–º–µ–Ω—Ç: –¥–∞—Ç–∞_–Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –≤ —Ñ–æ—Ä–º–∞—Ç—ñ 'YYYY-MM-DD'
    """
    birth_date = datetime.datetime.strptime(birth_date_str, '%Y-%m-%d')
    today = datetime.datetime.now()

    # 1. –í—ñ–∫
    age = today.year - birth_date.year
    if (today.month, today.day) < (birth_date.month, birth_date.day):
        age -= 1

    # 2. –î–Ω—ñ –¥–æ –¥–Ω—è –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
    birthday_this_year = birth_date.replace(year=today.year)
    if birthday_this_year < today:
        birthday_this_year = birth_date.replace(year=today.year + 1)

    days_until_birthday = (birthday_this_year - today).days

    # 3. –°—Ç–æ–ª—ñ—Ç—Ç—è
    century = (birth_date.year - 1) // 100 + 1

    return {
        '–≤—ñ–∫': age,
        '–¥–Ω—ñ–≤_–¥–æ_–¥–Ω—è_–Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è': days_until_birthday,
        '—Å—Ç–æ–ª—ñ—Ç—Ç—è': century,
        '–¥–∞—Ç–∞_–Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è': birth_date.strftime('%d.%m.%Y')
    }

# –¢–µ—Å—Ç
data = calculate_age_info('1995-03-20')
print("\n–ü—Ä–∏–∫–ª–∞–¥: –¥–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è 20.03.1995")
print(f"  –í—ñ–∫: {data['–≤—ñ–∫']} —Ä–æ–∫—ñ–≤")
print(f"  –î–Ω—ñ–≤ –¥–æ –¥–Ω—è –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è: {data['–¥–Ω—ñ–≤_–¥–æ_–¥–Ω—è_–Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è']}")
print(f"  –ù–∞—Ä–æ–¥–∏–ª–∞—Å—å —É {data['—Å—Ç–æ–ª—ñ—Ç—Ç—è']} —Å—Ç–æ–ª—ñ—Ç—Ç—ñ")

print()

# ============================================================================
# 2. –ü–†–û–ï–ö–¢ 2: –ì–ï–ù–ï–†–ê–¢–û–† –ü–ê–†–û–õ–Ø
# ============================================================================

print("\n" + "=" * 70)
print("–ü–†–û–ï–ö–¢ 2: –ì–ï–ù–ï–†–ê–¢–û–† –ë–ï–ó–ü–ï–ß–ù–û–ì–û –ü–ê–†–û–õ–Ø")
print("=" * 70)

print("""
–ó–∞–≤–¥–∞–Ω–Ω—è: –ù–∞–ø–∏—à—ñ—Ç—å –ø—Ä–æ–≥—Ä–∞–º—É —â–æ –≥–µ–Ω–µ—Ä—É—î –±–µ–∑–ø–µ—á–Ω—ñ –ø–∞—Ä–æ–ª—ñ:
  1. –î–æ–≤–∂–∏–Ω–∞ –Ω–µ –º–µ–Ω—à–µ 12 —Å–∏–º–≤–æ–ª—ñ–≤
  2. –ú—ñ—Å—Ç–∏—Ç—å –±—É–∫–≤–∏ (–≤–µ—Ä—Ö–Ω—ñ–π —Ç–∞ –Ω–∏–∂–Ω—ñ–π —Ä–µ–≥—ñ—Å—Ç—Ä)
  3. –ú—ñ—Å—Ç–∏—Ç—å —Ü–∏—Ñ—Ä–∏
  4. –ú—ñ—Å—Ç–∏—Ç—å —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ —Å–∏–º–≤–æ–ª–∏ (!@#$%^&*)

–ù–∞–≤–∏—á–∫–∏: random, —Å—Ç—Ä–æ–∫–∏, –≤–∞–ª—ñ–¥–∞—Ü—ñ—è
""")

def generate_password(length=12):
    """
    –ì–µ–Ω–µ—Ä—É—î –±–µ–∑–ø–µ—á–Ω–∏–π –ø–∞—Ä–æ–ª—å.
    –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞ 8 —Å–∏–º–≤–æ–ª—ñ–≤.
    """
    if length < 8:
        raise ValueError("–ü–∞—Ä–æ–ª—å –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –º—ñ–Ω—ñ–º—É–º 8 —Å–∏–º–≤–æ–ª—ñ–≤")

    lowercase = "abcdefghijklmnopqrstuvwxyz"
    uppercase = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
    digits = "0123456789"
    special = "!@#$%^&*()_+-=[]{}|;:,.<>?"

    # –ì–∞—Ä–∞–Ω—Ç—É—î–º–æ –º—ñ–Ω—ñ–º—É–º –æ–¥–∏–Ω —Å–∏–º–≤–æ–ª –∑ –∫–æ–∂–Ω–æ—ó –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
    password = [
        random.choice(lowercase),
        random.choice(uppercase),
        random.choice(digits),
        random.choice(special)
    ]

    # –ó–∞–ø–æ–≤–Ω—é—î–º–æ —Ö–≤—ñ—Å—Ç –≤–∏–ø–∞–¥–∫–æ–≤–∏–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏
    all_chars = lowercase + uppercase + digits + special
    for _ in range(length - 4):
        password.append(random.choice(all_chars))

    # –ü–µ—Ä–µ–º—ñ—à—É—î–º–æ
    random.shuffle(password)
    return ''.join(password)

def check_password(password):
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î —á–∏ –ø–∞—Ä–æ–ª—å –±–µ–∑–ø–µ—á–Ω–∏–π."""
    errors = []

    if len(password) < 8:
        errors.append("–ú—ñ–Ω—ñ–º—É–º 8 —Å–∏–º–≤–æ–ª—ñ–≤")

    if not re.search(r'[a-z]', password):
        errors.append("–ü–æ—Ç—Ä–µ–±—É—î –º–∞–ª–∏—Ö –±—É–∫–≤")

    if not re.search(r'[A-Z]', password):
        errors.append("–ü–æ—Ç—Ä–µ–±—É—î –≤–µ–ª–∏–∫–∏—Ö –±—É–∫–≤")

    if not re.search(r'\d', password):
        errors.append("–ü–æ—Ç—Ä–µ–±—É—î —Ü–∏—Ñ—Ä–∏")

    if not re.search(r'[!@#$%^&*()_+\-=\[\]{}|;:,.<>?]', password):
        errors.append("–ü–æ—Ç—Ä–µ–±—É—î —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤")

    return errors

# –¢–µ—Å—Ç
password = generate_password(12)
errors = check_password(password)

print("\n–ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π –ø–∞—Ä–æ–ª—å:")
print(f"  {password}")
print(f"  –ë–µ–∑–ø–µ—á–Ω—ñ—Å—Ç—å: {'‚úÖ OK' if not errors else '‚ùå –ü–æ–º–∏–ª–∫–∏: ' + ', '.join(errors)}")

print()

# ============================================================================
# 3. –ü–†–û–ï–ö–¢ 3: –û–ë–†–û–ë–ö–ê CSV –ó –ö–û–ù–¢–ê–ö–¢–ê–ú–ò
# ============================================================================

print("\n" + "=" * 70)
print("–ü–†–û–ï–ö–¢ 3: –£–ü–†–ê–í–õ–Ü–ù–ù–Ø –ö–û–ù–¢–ê–ö–¢–ê–ú–ò (CSV)")
print("=" * 70)

print("""
–ó–∞–≤–¥–∞–Ω–Ω—è: –°—Ç–≤–æ—Ä—ñ—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤:
  1. –î–æ–¥–∞–≤–∞—Ç–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∏ (—ñ–º'—è, email, —Ç–µ–ª–µ—Ñ–æ–Ω)
  2. –®—É–∫–∞—Ç–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∏ –ø–æ —ñ–º'—é
  3. –í–∏–¥–∞–ª—è—Ç–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∏
  4. –ó–±–µ—Ä—ñ–≥–∞—Ç–∏ –≤ CSV —Ñ–∞–π–ª

–ù–∞–≤–∏—á–∫–∏: CSV, —Å–ª–æ–≤–Ω–∏–∫–∏, —Ñ—É–Ω–∫—Ü—ñ—ó
""")

contacts_file = "contacts.csv"

def init_contacts():
    """–°—Ç–≤–æ—Ä—é—î CSV —Ñ–∞–π–ª —è–∫—â–æ –π–æ–≥–æ –Ω–µ–º–∞—î."""
    if not os.path.exists(contacts_file):
        with open(contacts_file, 'w', newline='', encoding='utf-8') as f:
            writer = csv.DictWriter(f, fieldnames=['name', 'email', 'phone'])
            writer.writeheader()

def add_contact(name, email, phone):
    """–î–æ–¥–∞—î –Ω–æ–≤–∏–π –∫–æ–Ω—Ç–∞–∫—Ç."""
    with open(contacts_file, 'a', newline='', encoding='utf-8') as f:
        writer = csv.DictWriter(f, fieldnames=['name', 'email', 'phone'])
        writer.writerow({'name': name, 'email': email, 'phone': phone})

def search_contacts(search_word):
    """–®—É–∫–∞—î –∫–æ–Ω—Ç–∞–∫—Ç–∏ –ø–æ —ñ–º'—é."""
    results = []
    with open(contacts_file, 'r', encoding='utf-8') as f:
        reader = csv.DictReader(f)
        for contact in reader:
            if search_word.lower() in contact['name'].lower():
                results.append(contact)
    return results

def show_all():
    """–ü–æ–∫–∞–∑—É—î –≤—Å—ñ –∫–æ–Ω—Ç–∞–∫—Ç–∏."""
    contacts = []
    with open(contacts_file, 'r', encoding='utf-8') as f:
        reader = csv.DictReader(f)
        contacts = list(reader)
    return contacts

# –¢–µ—Å—Ç
init_contacts()

# –î–æ–¥–∞–º–æ –¥–µ—è–∫—ñ –∫–æ–Ω—Ç–∞–∫—Ç–∏
add_contact("–Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ", "ivan@example.com", "050-123-4567")
add_contact("–ú–∞—Ä—ñ—è –°–∏–¥–æ—Ä–µ–Ω–∫–æ", "maria@example.com", "066-234-5678")
add_contact("–ü–µ—Ç—Ä–æ –Ü–≤–∞–Ω–æ–≤", "petro@example.com", "095-345-6789")

# –ü–æ—à—É–∫
search_results = search_contacts("–Ü–≤–∞–Ω")

print("\n–í—Å—ñ –∫–æ–Ω—Ç–∞–∫—Ç–∏:")
for contact in show_all():
    print(f"  {contact['name']:20s} | {contact['email']:25s} | {contact['phone']}")

print(f"\n–ü–æ—à—É–∫ –ø–æ '–Ü–≤–∞–Ω' ({len(search_results)} —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤):")
for contact in search_results:
    print(f"  {contact['name']}")

print()

# ============================================================================
# 4. –ü–†–û–ï–ö–¢ 4: –ê–ù–ê–õ–Ü–ó–ê–¢–û–† –¢–ï–ö–°–¢–£
# ============================================================================

print("\n" + "=" * 70)
print("–ü–†–û–ï–ö–¢ 4: –ê–ù–ê–õ–Ü–ó–ê–¢–û–† –¢–ï–ö–°–¢–£")
print("=" * 70)

print("""
–ó–∞–≤–¥–∞–Ω–Ω—è: –ù–∞–ø–∏—à—ñ—Ç—å –ø—Ä–æ–≥—Ä–∞–º—É —â–æ –∞–Ω–∞–ª—ñ–∑—É—î —Ç–µ–∫—Å—Ç:
  1. –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ª—ñ–≤, —Ä–µ—á–µ–Ω—å
  2. –°–µ—Ä–µ–¥–Ω—è –¥–æ–≤–∂–∏–Ω–∞ —Å–ª–æ–≤–∞
  3. –ù–∞–π—á–∞—Å—Ç—ñ—à—ñ —Å–ª–æ–≤–∞ (—Ç–æ–ø-5)
  4. Email –∞–¥—Ä–µ—Å–∏ —Ç–∞ URL –≤ —Ç–µ–∫—Å—Ç—ñ

–ù–∞–≤–∏—á–∫–∏: —Ä–µ–≥—É–ª—è—Ä–Ω—ñ –≤–∏—Ä–∞–∑–∏, –æ–±—Ä–æ–±–∫–∞ —Å—Ç—Ä–æ–∫, collections
""")

def analyze_text(text):
    """–ê–Ω–∞–ª—ñ–∑—É—î —Ç–µ–∫—Å—Ç —Ç–∞ –ø–æ–≤–µ—Ä—Ç–∞—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É."""
    # –°–ª–æ–≤–∞
    words = re.findall(r'\b\w+\b', text.lower())

    # –†–µ—á–µ–Ω–Ω—è
    sentences = re.split(r'[.!?]+', text)
    sentences = [s for s in sentences if s.strip()]

    # Email
    emails = re.findall(r'\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.\w+\b', text)

    # URL
    urls = re.findall(r'https?://\S+', text)

    # –ù–∞–π—á–∞—Å—Ç—ñ—à—ñ —Å–ª–æ–≤–∞
    top_words = Counter(words).most_common(5)

    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    stats = {
        '—Å–ª—ñ–≤': len(words),
        '—Ä–µ—á–µ–Ω—å': len(sentences),
        '—Å—Ä–µ–¥–Ω—è_–¥–æ–≤–∂–∏–Ω–∞': sum(len(word) for word in words) / len(words) if words else 0,
        '—É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö': len(set(words)),
        '–µ–º–µ–π–ª—ñ–≤': emails,
        '—É—Ä–ª—ñ–≤': urls,
        '—Ç–æ–ø_5_—Å–ª—ñ–≤': top_words
    }

    return stats

# –¢–µ—Å—Ç
test_text = """
–ü—Ä–∏–≤—ñ—Ç! –¶–µ –ø—Ä–∏–∫–ª–∞–¥ —Ç–µ–∫—Å—Ç—É –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É.
–ù–∞–ø–∏—à—ñ—Ç—å –º–µ–Ω—ñ –Ω–∞ ivan@example.com –∞–±–æ –≤—ñ–¥–≤—ñ–¥–∞–π—Ç–µ https://example.com.
–¶–µ –¥—É–∂–µ –∫–æ—Ä–∏—Å–Ω–∏–π —Ç–µ–∫—Å—Ç. –î—É–∂–µ –∫–æ—Ä–∏—Å–Ω–∏–π!
"""

stat = analyze_text(test_text)

print("\n–ê–Ω–∞–ª—ñ–∑ —Ç–µ–∫—Å—Ç—É:")
print(f"  –°–ª—ñ–≤: {stat['—Å–ª—ñ–≤']}")
print(f"  –†–µ—á–µ–Ω—å: {stat['—Ä–µ—á–µ–Ω—å']}")
print(f"  –°–µ—Ä–µ–¥–Ω—è –¥–æ–≤–∂–∏–Ω–∞ —Å–ª–æ–≤–∞: {stat['—Å—Ä–µ–¥–Ω—è_–¥–æ–≤–∂–∏–Ω–∞']:.1f}")
print(f"  –£–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö —Å–ª—ñ–≤: {stat['—É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö']}")
print(f"  Email –∞–¥—Ä–µ—Å–∏: {stat['–µ–º–µ–π–ª—ñ–≤']}")
print(f"  URL –∞–¥—Ä–µ—Å–∏: {stat['—É—Ä–ª—ñ–≤']}")
print(f"  –¢–æ–ø 5 —Å–ª—ñ–≤: {stat['—Ç–æ–ø_5_—Å–ª—ñ–≤']}")

print()

# ============================================================================
# 5. –ü–†–û–ï–ö–¢ 5: –¢–†–ï–ö–ï–† –í–ò–¢–†–ê–¢
# ============================================================================

print("\n" + "=" * 70)
print("–ü–†–û–ï–ö–¢ 5: –ü–†–û–°–¢–ò–ô –¢–†–ï–ö–ï–† –í–ò–¢–†–ê–¢")
print("=" * 70)

print("""
–ó–∞–≤–¥–∞–Ω–Ω—è: –°—Ç–≤–æ—Ä—ñ—Ç—å —Ç—Ä–µ–∫–µ—Ä –≤–∏—Ç—Ä–∞—Ç:
  1. –î–æ–¥–∞–≤–∞—Ç–∏ –≤–∏—Ç—Ä–∞—Ç–∏ (–¥–∞—Ç–∞, –∫–∞—Ç–µ–≥–æ—Ä—ñ—è, —Å—É–º–∞)
  2. –†–æ–∑—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –≤–∏—Ç—Ä–∞—Ç–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º
  3. –†–æ–∑—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ —Å–µ—Ä–µ–¥–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏
  4. –ó–±–µ—Ä—ñ–≥–∞—Ç–∏ –≤ JSON —Ñ–∞–π–ª

–ù–∞–≤–∏—á–∫–∏: datetime, JSON, —Å–ª–æ–≤–Ω–∏–∫–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
""")

expenses_file = "expenses.json"

def init_expenses():
    """–°—Ç–≤–æ—Ä—é—î JSON —Ñ–∞–π–ª —è–∫—â–æ –π–æ–≥–æ –Ω–µ–º–∞—î."""
    if not os.path.exists(expenses_file):
        with open(expenses_file, 'w', encoding='utf-8') as f:
            json.dump([], f, ensure_ascii=False, indent=2)

def add_expense(category, amount, date=None):
    """–î–æ–¥–∞—î –≤–∏—Ç—Ä–∞—Ç—É."""
    if date is None:
        date = datetime.datetime.now().strftime('%Y-%m-%d')

    with open(expenses_file, 'r', encoding='utf-8') as f:
        expenses = json.load(f)

    expenses.append({
        '–¥–∞—Ç–∞': date,
        '–∫–∞—Ç–µ–≥–æ—Ä—ñ—è': category,
        '—Å—É–º–∞': amount
    })

    with open(expenses_file, 'w', encoding='utf-8') as f:
        json.dump(expenses, f, ensure_ascii=False, indent=2)

def get_expense_stats():
    """–†–æ–∑—Ä–∞—Ö–æ–≤—É—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤–∏—Ç—Ä–∞—Ç."""
    with open(expenses_file, 'r', encoding='utf-8') as f:
        expenses = json.load(f)

    if not expenses:
        return {
            '—Å—É–º–º–∞': 0,
            '–ø–æ_–∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º': {},
            '—Å—Ä–µ–¥–Ω—è': 0
        }

    by_category = {}
    total = 0

    for expense in expenses:
        category = expense['–∫–∞—Ç–µ–≥–æ—Ä—ñ—è']
        amount = expense['—Å—É–º–∞']

        if category not in by_category:
            by_category[category] = 0
        by_category[category] += amount
        total += amount

    return {
        '—Å—É–º–º–∞': total,
        '–ø–æ_–∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º': by_category,
        '—Å—Ä–µ–¥–Ω—è': total / len(expenses) if expenses else 0
    }

# –¢–µ—Å—Ç
init_expenses()

# –î–æ–¥–∞–º–æ –≤–∏—Ç—Ä–∞—Ç–∏
add_expense("–á–¥–∞", 250)
add_expense("–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç", 80)
add_expense("–á–¥–∞", 150)
add_expense("–†–æ–∑–≤–∞–≥–∏", 200)

stat = get_expense_stats()

print("\n–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∏—Ç—Ä–∞—Ç:")
print(f"  –ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞: {stat['—Å—É–º–º–∞']} –≥—Ä–Ω")
print(f"  –°–µ—Ä–µ–¥–Ω—è –≤–∏—Ç—Ä–∞—Ç–∞: {stat['—Å—Ä–µ–¥–Ω—è']:.2f} –≥—Ä–Ω")
print(f"\n–ü–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º:")
for category, amount in stat['–ø–æ_–∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º'].items():
    print(f"  {category:15s}: {amount} –≥—Ä–Ω")

print()

# ============================================================================
# –í–ò–°–ù–û–í–ö–ò
# ============================================================================

print("\n" + "=" * 70)
print("–í–ò–°–ù–û–í–ö–ò")
print("=" * 70)

print("""
‚úÖ –ù–∞–≤–∏—á–∫–∏ —â–æ –≤–∏ –æ—Ç—Ä–∏–º–∞–ª–∏:
  1. –†–æ–±–æ—Ç–∏ –∑ –¥–∞—Ç–∞–º–∏ (datetime)
  2. –ì–µ–Ω–µ—Ä—É–≤–∞–Ω–Ω—è —Ç–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è (–ø–∞—Ä–æ–ª—ñ)
  3. CSV –æ–±—Ä–æ–±–∫–∞ (–∫–æ–Ω—Ç–∞–∫—Ç–∏)
  4. –†–µ–≥—É–ª—è—Ä–Ω—ñ –≤–∏—Ä–∞–∑–∏ (–∞–Ω–∞–ª—ñ–∑ —Ç–µ–∫—Å—Ç—É)
  5. JSON –æ–±—Ä–æ–±–∫–∞ (—Ç—Ä–µ–∫–µ—Ä –≤–∏—Ç—Ä–∞—Ç)
  6. –û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—è –∫–æ–¥—É –≤ —Ñ—É–Ω–∫—Ü—ñ—ó
  7. –†–æ–±–æ—Ç–∞ –∑ —Ñ–∞–π–ª–∞–º–∏

üí° –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:
  1. –†–æ–∑—à–∏—Ä—Ç–µ —Ü—ñ –ø—Ä–æ–µ–∫—Ç–∏ (–¥–æ–¥–∞–π—Ç–µ UI, –±–∞–∑—É –¥–∞–Ω–∏—Ö)
  2. –ö–æ–º–±—ñ–Ω—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç–∏ —Ä–∞–∑–æ–º
  3. –í–∏–∫–æ–Ω–∞–π—Ç–µ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∑–∞–≤–¥–∞–Ω–Ω—è –≤ –∫—ñ–Ω—Ü—ñ –∫–æ–∂–Ω–æ–≥–æ –º–æ–¥—É–ª—è
  4. –í–∏–≤—á–∞–π—Ç–µ –±—ñ–ª—å—à —Å–∫–ª–∞–¥–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ (requests, pandas, etc)

üöÄ –ì–æ—Ç–æ–≤—ñ –¥–æ Production?
  –¢–µ–ø–µ—Ä –º–æ–∂–Ω–∞ —Ä—É—Ö–∞—Ç–∏—Å—è –Ω–∞ Pro Edition!
""")

# –û—á–∏—Å—Ç–∫–∞
if os.path.exists(contacts_file):
    os.remove(contacts_file)

if os.path.exists(expenses_file):
    os.remove(expenses_file)

print("\n(–¢–µ—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –æ—á–∏—â–µ–Ω–æ)")
